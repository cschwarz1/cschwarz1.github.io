<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>modern internal security assessments | home</title><meta name=keywords content><meta name=description content="In this blog post I'll discuss a simplified aproach to internal security assessments. We will take a look at different testing scenarios and variants and their methodologies and why organizations in the vast majority of cases probably don't want/need a red team assessment."><meta name=author content="c"><link rel=canonical href=https://cschwarz1.github.io/posts/0x02/><link crossorigin=anonymous href=/assets/css/stylesheet.min.ef433f52b2f4200b69b3e4cc7a716c6232d42296fab86ed36376595a2896714d.css integrity="sha256-70M/UrL0IAtps+TMenFsYjLUIpb6uG7TY3ZZWiiWcU0=" rel="preload stylesheet" as=style><link rel=icon href=https://cschwarz1.github.io/favicon.ico><link rel=apple-touch-icon href=https://cschwarz1.github.io/apple-touch-icon.png><meta name=twitter:card content="summary"><meta name=twitter:title content="modern internal security assessments | home"><meta name=twitter:description content="In this blog post I'll discuss a simplified aproach to internal security assessments. We will take a look at different testing scenarios and variants and their methodologies and why organizations in the vast majority of cases probably don't want/need a red team assessment."><meta property="og:title" content="modern internal security assessments | home"><meta property="og:description" content="In this blog post I'll discuss a simplified aproach to internal security assessments. We will take a look at different testing scenarios and variants and their methodologies and why organizations in the vast majority of cases probably don't want/need a red team assessment."><meta property="og:type" content="article"><meta property="og:url" content="https://cschwarz1.github.io/posts/0x02/"><meta property="og:image" content="https://cschwarz1.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-06-06T23:05:45+01:00"><meta property="article:modified_time" content="2023-06-06T23:05:45+01:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://cschwarz1.github.io/posts/"},{"@type":"ListItem","position":2,"name":"modern internal security assessments","item":"https://cschwarz1.github.io/posts/0x02/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"modern internal security assessments | home","name":"modern internal security assessments","description":"In this blog post I'll discuss a simplified aproach to internal security assessments. We will take a look at different testing scenarios and variants and their methodologies and why organizations in the vast majority of cases probably don't want/need a red team assessment.","keywords":[],"wordCount":"1706","inLanguage":"en","datePublished":"2023-06-06T23:05:45+01:00","dateModified":"2023-06-06T23:05:45+01:00","author":{"@type":"Person","name":"c"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://cschwarz1.github.io/posts/0x02/"},"publisher":{"@type":"Organization","name":"home","logo":{"@type":"ImageObject","url":"https://cschwarz1.github.io/favicon.ico"}}}</script><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript></head><body class="dark type-posts kind-page layout-" id=top><script data-no-instant>function switchTheme(e){switch(e){case"light":document.body.classList.remove("dark");break;case"dark":document.body.classList.add("dark");break;default:window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")}}function isDarkTheme(){return document.body.className.includes("dark")}function getPrefTheme(){return localStorage.getItem("pref-theme")}function setPrefTheme(e){switchTheme(e),localStorage.setItem("pref-theme",e)}const toggleThemeCallbacks={};toggleThemeCallbacks.main=e=>{setPrefTheme(e?"light":"dark")},window.addEventListener("toggle-theme",function(){const e=isDarkTheme();for(const t in toggleThemeCallbacks)toggleThemeCallbacks[t](e)});function toggleThemeListener(){window.dispatchEvent(new CustomEvent("toggle-theme"))}</script><script>(function(){const t="dark",e=getPrefTheme(),n=e||t;switchTheme(n)})()</script><header class=header><nav class=nav><div class=logo><a href=https://cschwarz1.github.io/ accesskey=h title="home (Alt + H)">home</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://cschwarz1.github.io/categories/ title=categories>categories</a></li><li><a href=https://cschwarz1.github.io/tags/ title=tags>tags</a></li><li><a href=https://cschwarz1.github.io/aboutme/ title="about me">about me</a></li></ul></nav></header><main class="main post"><article class=post-single><header class=post-header><h1 class=post-title>modern internal security assessments</h1><div class=post-description>In this blog post I'll discuss a simplified aproach to internal security assessments. We will take a look at different testing scenarios and variants and their methodologies and why organizations in the vast majority of cases probably don't want/need a red team assessment.</div><div class=post-meta><span class=meta-item><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select:text"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select:text"/><line x1="16" y1="2" x2="16" y2="6" style="user-select:text"/><line x1="8" y1="2" x2="8" y2="6" style="user-select:text"/><line x1="3" y1="10" x2="21" y2="10" style="user-select:text"/></svg><span>June 6, 2023</span></span><span class=meta-item><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text" style="user-select:text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z" style="user-select:text"/><polyline points="14 2 14 8 20 8" style="user-select:text"/><line x1="16" y1="13" x2="8" y2="13" style="user-select:text"/><line x1="16" y1="17" x2="8" y2="17" style="user-select:text"/><polyline points="10 9 9 9 8 9" style="user-select:text"/></svg>
<span>1706 words</span></span><span class=meta-item><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>9 min</span></span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#short-intro aria-label="short intro">short intro</a><ul><li><a href=#pentest aria-label=pentest>pentest</a></li><li><a href=#more-modern---purple-teams aria-label="more modern - purple teams">more modern - purple teams</a></li><li><a href=#red-teaming aria-label="red teaming">red teaming</a></li></ul></li></ul></div></details></div><div class=post-content><h2 id=short-intro>short intro</h2><p>What should be the objectives of such a modern internal security assessment in regards to nowadys threats? It surely is not to showcase one&rsquo;s hacking skills, but to educate the company on how attackers operate, plan, and execute their attacks. The final outcome of the assessment should result in significant learning opportunities for the IT security team, which they can implement immediately after the assessment ends. Depending on the organization&rsquo;s maturity, they will know how to continue to implement, improve or fine-tune their security processes and defenses. This reaches from eliminating years-long dormant miconfigurations, drastically reducing the attack surface, protecting sensitive assets, and finally improving early detection rates.</p><h3 id=pentest>pentest</h3><p>Contrairy to some of my peers in the security community I&rsquo;m still a fan of the traditional pentest with some modern flavor added. It is astonishing how many clients, despite having multiple security products with all the latest features, were shocked to discover how easily it was to escalate privileges without the use of complex malware, sophistcated tools or command and control frameworks. Given enough time in a network with bad security very trivial attacks can lead to complete take-over of the domain. Security detections have many blind spots and once administrator access is compromised, it is oftentimes already too late to react and the damage is done.</p><p>Conducting this newly-flavored pentest to demonstrate that sometimes even a non-technical person can carry out these types of attacks, may already be an eye-opening experience and massive learning for the company. Moving through the network with a low-privilege user, with a malicious goal in mind, even within the limitations set by administrators, is highly effective. However, using readily available exploits or implants in nowadys intranets like we did in the early days of internal security assessments is unlikely to succeed and will be blocked by most antivirus or endpoint detection and response systems.</p><p>I still see some benefits, once the domain has been taken over silently, to slowly ramp up the testing noise, to get a feeling on how the organization reacts to alerts, if they can make contextual sense out of them and if those alarms actually arrive in time, and not hours later, as seen many times in multiple engagements.</p><p>So needless to say in those types of penetration tests, it is advisable for the company to keep all their security products and logging active, allowing the pentester to see how they respond and addtional give some learning and analysis material for the time after the test.</p><h3 id=more-modern---purple-teams>more modern - purple teams</h3><p>A purple team engagement is a type of internal assessment that combines the skills and techniques of both red and blue teams to improve an organization&rsquo;s overall security posture. A red team is typically responsible for simulating real-world attacks and testing an organization&rsquo;s security measures, while a blue team is responsible for defending against those attacks and maintaining the security of the organization.</p><p>In a purple team engagement, the red and blue teams work together to identify and address any vulnerabilities or weaknesses in the organization&rsquo;s security systems. The red team will attempt to penetrate the organization&rsquo;s defenses, and the blue team will respond and attempt to mitigate any successful attacks. Throughout the engagement, the teams will communicate and collaborate to identify areas for improvement and develop actionable plans for enhancing the organization&rsquo;s security. The goal of a purple team engagement is to provide a comprehensive and realistic evaluation of an organization&rsquo;s security posture and to develop a roadmap for continuous improvement.</p><p>Such an engagement can offer additional benefits to organizations that have a stronger foundational security. However, to make the most of this type of assessment, it&rsquo;s important for the organization to have a dedicated security team, or blue team, in place. Without knowledgeable techy security personell there is a risk of overwhelming clients with security issues and remediation measures that they may not be familiar with, which can ultimately harm the relationship. Unfortunately, in my experience, it is still quite uncommon for companies to have a dedicated threat hunter, let alone an entire security department. It&rsquo;s essential to keep this in mind when considering a purple team internal assessment.</p><p>One of the key goals of purple teaming is to improve detection capabilities. This is achieved by merging the perspectives and expertise of both the offensive and defensive sides of security. Historically, purple teaming was typically conducted after a thorough red teaming engagement, but in recent times, there has been a shift in this approach. Nowadays, it&rsquo;s becoming more common to perform a purple teaming engagement even without prior red teaming. This shift in approach highlights the importance of combining the strengths of both red and blue teams to provide a comprehensive and holistic assessment of an organization&rsquo;s security defenses. This also allows for the execution of implants and tactics that simulate real-world attacks, testing both the detection capabilities and the response of the blue team. The primary goal of these engagements is to simulate a realistic intrusion scenario and evaluate the organization&rsquo;s defenses against potential adversaries.</p><p>While evaluating a vendor&rsquo;s anti-intrusion solutions is not the primary focus of a purple team engagement, those defenses should remain active throughout the engagement. To save time and cost the solutions can be set to alert-only for example. I mention the alert-only mode as it is important to state the obvious that most security solutions, including Anti-Virus (AV) and EDRs, can be bypassed by attackers. Therefore, the general question arises as to whether the client should invest the time and resources to evade their security products or focus on how an attacker might proceed in the event that the solution has already been bypassed, which is also known as <em>assumed breach</em>.</p><p>This approach should definately operate under the premise that a successful attack on the organization&rsquo;s systems has already occurred and the attacker has bypassed its defenses. The purpose of this variant is to simulate a post-breach scenario and evaluate the organization&rsquo;s ability to detect, respond to, and mitigate the consequences of a real attack.</p><p>In an <em>assumed breach</em> scenario, the blue team acts as if an attacker has already gained access to the systems and is attempting to move laterally and exfiltrate sensitive data. The goal is to evaluate the organization&rsquo;s incident response and incident management processes, as well as its ability to detect movements, interrupt access and contain the breach. The focus is more on evaluating the organization&rsquo;s ability to respond to and mitigate the impact of a real attack, rather than on testing the efficacy of its security solutions.</p><h3 id=red-teaming>red teaming</h3><figure class=center><img loading=lazy src=/images/7abrst.jpg width=700px height=400></figure><p>Mostly if you ask yourself as a company if you need a red team assessment the answer is usually no, unless your infrastructure is exceptionally secure by design and the security team consistently employs proactive threat hunting, and you are constantly evaluating and reinforcing the organizational security processes.</p><blockquote><p>But I want a red team to test our security solutions</p></blockquote><p>Save your money, unless you are willing to spend big bucks and you have the personell to deal with an active intrusion. In a lower budget red-team like assessment a consulting firm will not divert a lot of personell to actively bypass all the protections in place. Such techniques require a lot of time-intensive preparations. Additionally if the price isn&rsquo;t right no one will spend their precious EDR bypass research on such an assessment, as the risk of having their techniques and implants analysed and signatured is just too high. As a result you will end up (happily) with a lot of detections and might think you are safe, when in reality real-life adversary play in a different league all together. For a couple of millions of ransomware money everyone will risk a burned malware or implant.</p><p>A red team engagement, which simulates real-world attacks on an organization&rsquo;s infrastructure, typically involves a multi-week or multi-month effort, requiring a well-coordinated team with specialized skills. Usually at least 4 different roles are assigned, depending on the scope of the assessment this can be 1 or more persons per role:</p><ul><li>a team lead or project manager</li><li>a person responsible for initial access and maintaining this access</li><li>a person to programmatically bypass security defenses, i.e. a coder</li><li>a highly skilled operator who compromises systems, moves laterally, executes the mission</li></ul><p>The factor of time is also crucial in red team operations. Consider a basic scan for open SMB network shares within an organization&rsquo;s intranet. Most robust security systems, such as an EDR or IPS, will flag this type of activity as highly suspicious. However, if the same scan is spread out over several days or weeks and blended in with normal daily user network traffic, it becomes much more difficult to detect. Although the end result is the same, it just took the red team operators a couple of weeks to enumerate the internal attack surface.</p><p>A dedicated blue team, responsible for defending against these simulated attacks, must be able to effectively respond and counteract the red team&rsquo;s actions, which can divert important resources and manpower away from their daily tasks. This adds to the overall costs for the client and should be taken into account as well.</p><p>Given the complexity and cost of red team engagements, it&rsquo;s evident that for many organizations, such engagements may not be the best solution for their needs. This is especially true for organizations that lack a dedicated budget and a blue team capable of effectively defending against simulated attacks. As a result, it may be more appropriate for these organizations to consider alternative forms of security assessments, such as a modern pentest or a purple team engagement, until they have met the necessary preconditions to undertake a red team engagement.</p><p>that&rsquo;s it for now, some final words: security is hard, getting owned and cleaning up the mess is harder. Security products are incredible powerful in the hand of skilled people but you should&rsquo;nt rely on them when you have general bad security. Invest in active dedicated defenders (humans). With every security product you buy, hire a threat-hunter and make the most out of it.</p><p>Get in <a href=mailto:cschwarz1@proton.me>contact</a> if you agree or more importantly if not, I want to hear why. Thanks for reading and see you in the next one.</p></div><footer class=post-footer></footer><div class=comments-separator></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://cschwarz1.github.io/>home</a></span><span style=display:inline-block;margin-left:1em>
<a href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA</a></span>
<span style=display:inline-block;margin-left:1em>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
    <a href=https://github.com/reorx/hugo-PaperModX/ rel=noopener target=_blank>PaperModX</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>(function(){const t=""=="1";if(t)return;let e=document.getElementById("theme-toggle");e.removeEventListener("click",toggleThemeListener),e.addEventListener("click",toggleThemeListener)})()</script><script>(function(){let e=document.getElementById("menu");e&&(e.scrollLeft=localStorage.getItem("menu-scroll-position"),e.onscroll=function(){localStorage.setItem("menu-scroll-position",e.scrollLeft)});const t=""=="1",n=""=="1";if(window.matchMedia("(prefers-reduced-motion: reduce)").matches||t||n)return;document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})})()</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>if(window.scrollListeners)for(const e of scrollListeners)window.removeEventListener("scroll",e);window.scrollListeners=[]</script><script src=/js/medium-zoom.min.js data-no-instant></script>
<script>(function(){const a=""=="1";if(!a)return;if(!document.querySelector(".toc")){console.log("no toc found, ignore toc scroll");return}const r=window.scrollListeners,t=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id]"),n="active";let e=t[0];o(e).classList.add(n);const c=()=>{const s=[];for(const e of t)if(l(e)<5)s.push(e);else break;s.length>0?newActiveHeading=s[s.length-1]:newActiveHeading=t[0],e!=newActiveHeading&&(o(e).classList.remove(n),e=newActiveHeading,o(e).classList.add(n))};let s=null;const i=()=>{s!==null&&clearTimeout(s),s=setTimeout(c,50)};window.addEventListener("scroll",i,!1),r.push(i);function o(e){const t=encodeURI(e.getAttribute("id")).toLowerCase();return document.querySelector(`.toc ul li a[href="#${t}"]`)}function l(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect();return t.top}})()</script></body></html>